<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>masimplo's blog | Waiting for progress...</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="Waiting for progress...">
  <meta property="og:type" content="website">
  <meta property="og:url" content="/posts/waiting-for-progress">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="masimplo's blog">
  <meta property="og:image" content="/assets/og-image.jpg">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="/posts/waiting-for-progress">
  <meta name="twitter:title" content="Waiting for progress...">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="/assets/og-image.jpg">

  <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
  <link href="/feed.xml" type="application/rss+xml" rel="alternate" title="masimplo's blog Last 10 blog posts" />

  
    <link type="text/css" rel="stylesheet" href="/assets/light.css">
  
</head>

<body>
  <main role="main">
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav reveal">
  <a href="" class="header-logo" title="masimplo's blog">masimplo's blog</a>
  <ul class="header-links">
    
      <li>
        <a href="https://twitter.com/masimplo" target="_blank" title="Twitter">
          <span class="icon icon-social-twitter"></span>
        </a>
      </li>
    
    
    
      <li>
        <a href="https://github.com/masimplo" target="_blank" title="GitHub">
          <span class="icon icon-social-github"></span>
        </a>
      </li>
    
    
    
      <li>
        <a href="https://www.linkedin.com/in/masimplo" target="_blank" title="LinkedIn">
          <span class="icon icon-social-linkedin"></span>
        </a>
      </li>
    
    
    
      <li>
        <a href="mailto:masimplo@gmail.com" target="_blank" title="Email">
          <span class="icon icon-at"></span>
        </a>
      </li>
    
    
      <li>
        <a href="/feed.xml" target="_blank" title="RSS">
          <span class="icon icon-social-rss"></span>
        </a>
      </li>
    
  </ul>
</nav>

        <article class="article reveal">
          <header class="article-header">
            <h1>Waiting for progress...</h1>
            <p></p>
            <div class="article-list-footer">
              <span class="article-list-date">
                November 22, 2012
              </span>
              <span class="article-list-divider">-</span>
              <span class="article-list-minutes">
                
                
                  2 minute read
                
              </span>
              <span class="article-list-divider">-</span>
              <div class="article-list-tags">
                
              </div>
            </div>
          </header>

          <div class="article-content">
            <p>Όταν μια εφαρμογή έχει πολλές χρονοβόρες διαδικασίες τότε ένα progressbar στην κεντρική φόρμα είναι απαραίτητο, ώστε να μην υπάρχουν 200 progressbar δεξιά και αριστερά.
 Ωραία, ας βάλουμε το progressbar στην κεντρική φόρμα, εγώ όμως που είναι 15 φόρμες και 20 κλάσεις μακριά και κάνω ένα χρονοβόρο υπολογισμό τι κάνω;.
 Έχω δει ανθρώπους να κάνουν το progressbar public, να έχουν access μέσω static, ακόμα και να το περνάνε παντού ως παράμετρο. Δεν μπορεί… Πρέπει να υπάρχει μη καγκουρικος τρόπος σκέφτηκα. Και τότε μου ήρθε…</p>

<p>Μία class ονόματι StatusNotifier που απαρτίζεται από:</p>

<ul>
  <li>ένα event delegate
<code class="highlighter-rouge">public delegate void StatusChangedEventHandler(object sender, StatusEventArgs e);</code></li>
  <li>ένα event
<code class="highlighter-rouge">public static event StatusChangedEventHandler StatusChanged;</code></li>
  <li>και 1 μέθοδο</li>
</ul>

<p><code class="highlighter-rouge">public static void SetStatus(object sender, string status, int percentageDone = -1) {
      if (StatusChanged == null) return; // Make sure there are methods to execute
      StatusChanged(sender, new StatusEventArgs(status, percentageDone)); // Raise the event
}</code></p>

<p>Όποιος θέλει να ειδοποιήσει για το status μίας χρονοβόρας διαδικασίας απλά χρειάζεται να κάνει
<code class="highlighter-rouge">StatusNotifier.SetStatus(this, "Processing universal parameters of chaos...", 10);</code></p>

<p>Στην αντίπερα όχθη, στην mainForm της εφαρμογής η οποία έχει το statusbar αρκεί να κάνουμε register το statusChanged event
<code class="highlighter-rouge">StatusNotifier.StatusChanged += StatusNotifier_StatusChanged;</code>
 και να γράψουμε τι θέλουμε να γίνεται με τα δεδομένα που μας ήρθαν μέσω του event</p>

<div class="highlighter-rouge"><pre class="highlight"><code>void StatusNotifier_StatusChanged(object sender, StatusEventArgs e) {
   var percentageDone = e.PercentageDone;
   var statusText = e.status;

   if (percentageDone == -1) {
       progressBar.EditValue = 0;
       progressStatusLabel.Caption = string.Empty;
       progressBar.Visibility = BarItemVisibility.Never;
   } else {
       progressBar.Visibility = BarItemVisibility.Always;
       progressBar.EditValue = percentageDone;
       progressBar.Refresh();
   }
   progressStatusLabel.Caption = statusText;
   progressStatusLabel.Refresh();
}
</code></pre>
</div>


          </div>

          <div class="article-share">
            
            <a href="" title="Share on Twitter" onclick="window.open('https://twitter.com/home?status=Waiting for progress... - /posts/waiting-for-progress by @masimplo', 'newwindow', 'width=500, height=225'); return false;">
              <span class="icon icon-social-twitter"></span>
            </a>
            <a href="" title="Share on Facebook" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u=/posts/waiting-for-progress', 'newwindow', 'width=500, height=500'); return false;">
              <span class="icon icon-social-facebook"></span>
            </a>
            <a href="" title="Share on Google+" onclick="window.open('https://plus.google.com/share?url=/posts/waiting-for-progress', 'newwindow', 'width=550, height=400'); return false;">
              <span class="icon icon-social-googleplus"></span>
            </a>
          </div>

          
        </article>
        <footer class="footer reveal">

</footer>

      </div>
    </div>
  </main>
  <script type="text/javascript" src="/assets/vendor.js"></script>
<script type="text/javascript" src="/assets/application.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Cormorant Garamond:700', 'Lato:300,400,700']
    }
  });
</script>


  <script>
    window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date;
    ga('create','UA-28844594-2','auto');ga('send','pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>


</body>
</html>